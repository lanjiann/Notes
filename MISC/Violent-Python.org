#+TITLE: Violent Python
#+SUBTITLE: A Cookbook for Hackers, Forensic Analysts, Penetration Testers and Security Engineers
#+VERSION: 2013
#+AUTHOR: TJ. O'Connor
#+STARTUP: entitiespretty

* Table of Contents                                      :TOC_4_org:noexport:
- [[Trademarks][Trademarks]]
- [[Dedication][Dedication]]
- [[Lead Author – TJ O’Connor][Lead Author – TJ O’Connor]]
- [[Contributing Author Bio – Rob Frost][Contributing Author Bio – Rob Frost]]
- [[Technical Editor Bio – Mark Baggett][Technical Editor Bio – Mark Baggett]]
- [[Introduction][Introduction]]
- [[Chapter 1. Introduction][Chapter 1. Introduction]]
  - [[Introduction: A Penetration Test with Python][Introduction: A Penetration Test with Python]]
  - [[Setting Up Your Development Environment][Setting Up Your Development Environment]]
    - [[Installing Third Party Libraries][Installing Third Party Libraries]]
    - [[Interpreted Python Versus Interactive Python][Interpreted Python Versus Interactive Python]]
  - [[The Python Language][The Python Language]]
    - [[Variables][Variables]]
    - [[Strings][Strings]]
    - [[Lists][Lists]]
    - [[Dictionaries][Dictionaries]]
    - [[Networking][Networking]]
    - [[Selection][Selection]]
    - [[Exception Handling][Exception Handling]]
    - [[Functions][Functions]]
    - [[Iteration][Iteration]]
    - [[File I/O][File I/O]]
    - [[Sys Module][Sys Module]]
    - [[OS Module][OS Module]]
  - [[Your First Python Programs][Your First Python Programs]]
    - [[Setting the Stage for Your First Python Program: The Cuckoo’s Egg][Setting the Stage for Your First Python Program: The Cuckoo’s Egg]]
    - [[Your First Program, a UNIX Password Cracker][Your First Program, a UNIX Password Cracker]]
    - [[Setting the Stage for Your Second Program: Using Evil for Good][Setting the Stage for Your Second Program: Using Evil for Good]]
    - [[Your Second Program, a Zip-File Password Cracker][Your Second Program, a Zip-File Password Cracker]]
  - [[Chapter Wrap-Up][Chapter Wrap-Up]]
  - [[References][References]]
- [[Chapter 2. Penetration Testing with Python][Chapter 2. Penetration Testing with Python]]
  - [[Introduction: The Morris Worm—Would it Work Today?][Introduction: The Morris Worm—Would it Work Today?]]
  - [[Building a Port Scanner][Building a Port Scanner]]
    - [[TCP Full Connect Scan][TCP Full Connect Scan]]
    - [[Application Banner Grabbing][Application Banner Grabbing]]
    - [[Treading the Scan][Treading the Scan]]
    - [[Itegrating the Nmap Port Scanner][Itegrating the Nmap Port Scanner]]
  - [[Building an SSH BotNet with Python][Building an SSH BotNet with Python]]
    - [[Interacting with SSH Through Pexpect][Interacting with SSH Through Pexpect]]
    - [[Brute Forcing SSH Passwords with Pxssh][Brute Forcing SSH Passwords with Pxssh]]
    - [[Exploiting SSH Through Weak Private Keys][Exploiting SSH Through Weak Private Keys]]
    - [[Constructing the SSH Botnet][Constructing the SSH Botnet]]
  - [[Mass Compromise by Bridging FTP and Web][Mass Compromise by Bridging FTP and Web]]
    - [[Building an Anonymous FTP Scanner with Python][Building an Anonymous FTP Scanner with Python]]
    - [[Using Ftplib to Brute Force FTP User Credentials][Using Ftplib to Brute Force FTP User Credentials]]
    - [[Searching for Web Pages on the FTP Server][Searching for Web Pages on the FTP Server]]
    - [[Adding a Malicious Inject to Web Pages][Adding a Malicious Inject to Web Pages]]
    - [[Bringing the Entire Attack Together][Bringing the Entire Attack Together]]
  - [[Conficker, Why Trying Hard is Always Good Enough][Conficker, Why Trying Hard is Always Good Enough]]
    - [[Attacking the Windows SMB Service with Metasploit][Attacking the Windows SMB Service with Metasploit]]
    - [[Writing Python to Interact with Metasploit][Writing Python to Interact with Metasploit]]
    - [[Remote Process Execution Brute Force][Remote Process Execution Brute Force]]
    - [[Putting it Back Together to Build Our Own Conficker][Putting it Back Together to Build Our Own Conficker]]
  - [[Writing Your Own Zero-Day Proof of Concept Code][Writing Your Own Zero-Day Proof of Concept Code]]
    - [[Stack-Based Buffer Overflow Attacks][Stack-Based Buffer Overflow Attacks]]
    - [[Adding the Key Elements of the Attack][Adding the Key Elements of the Attack]]
    - [[Sending the Exploit][Sending the Exploit]]
    - [[Assembling the Entire Exploit Script][Assembling the Entire Exploit Script]]
  - [[Chapter Wrap Up][Chapter Wrap Up]]
  - [[References][References]]
- [[Chapter 3. Forensic Investigations with Python][Chapter 3. Forensic Investigations with Python]]
  - [[Introduction: How Forensics Solved the BTK Murders][Introduction: How Forensics Solved the BTK Murders]]
  - [[Where Have You Been?—Analysis of Wireless Access Points in the Registry][Where Have You Been?—Analysis of Wireless Access Points in the Registry]]
    - [[Using WinReg to Read the Windows Registry][Using WinReg to Read the Windows Registry]]
    - [[Using Mechanize to Submit the MAC Address to Wigle][Using Mechanize to Submit the MAC Address to Wigle]]
  - [[Using Python to Recover Deleted Items in the Recycle Bin][Using Python to Recover Deleted Items in the Recycle Bin]]
    - [[Using the OS Module to Find Deleted Items][Using the OS Module to Find Deleted Items]]
    - [[Python to Correlate SID to User][Python to Correlate SID to User]]
  - [[Metadata][Metadata]]
    - [[Using PyPDF to Parse PDF Metadata][Using PyPDF to Parse PDF Metadata]]
    - [[Understanding Exif Metadata][Understanding Exif Metadata]]
    - [[Downloading Images with BeautifulSoup][Downloading Images with BeautifulSoup]]
    - [[Reading Exif Metadata from Images with the Python Imaging Library][Reading Exif Metadata from Images with the Python Imaging Library]]
  - [[Investigating Application Artifacts with Python][Investigating Application Artifacts with Python]]
    - [[Understanding the Skype Sqlite3 Database][Understanding the Skype Sqlite3 Database]]
    - [[Using Python and Sqlite3 to Automate Skype Database Queries][Using Python and Sqlite3 to Automate Skype Database Queries]]
    - [[Parsing Firefox Sqlite3 Databases with Python][Parsing Firefox Sqlite3 Databases with Python]]
  - [[Investigating iTunes Mobile Backups with Python][Investigating iTunes Mobile Backups with Python]]
  - [[Chapter Wrap-Up][Chapter Wrap-Up]]
  - [[References][References]]
- [[Chapter 4. Network Traffic Analysis with Python][Chapter 4. Network Traffic Analysis with Python]]
  - [[Introduction: Operation Aurora and How the Obvious was Missed][Introduction: Operation Aurora and How the Obvious was Missed]]
  - [[Where is that IP Traffic Headed?—A Python Answer][Where is that IP Traffic Headed?—A Python Answer]]
    - [[Using PyGeoIP to Correlate IP to Physical Locations][Using PyGeoIP to Correlate IP to Physical Locations]]
    - [[Using Dpkt to Parse Packets][Using Dpkt to Parse Packets]]
    - [[Using Python to Build a Google Map][Using Python to Build a Google Map]]
  - [[Is Anonymous Really Anonymous? Analyzing LOIC Traffic][Is Anonymous Really Anonymous? Analyzing LOIC Traffic]]
    - [[Using Dpkt to Find the LOIC Download][Using Dpkt to Find the LOIC Download]]
    - [[Parsing IRC Commands to the Hive][Parsing IRC Commands to the Hive]]
    - [[Identifying the DDoS Attack in Progress][Identifying the DDoS Attack in Progress]]
  - [[How H D Moore Solved the Pentagon’s Dilemma][How H D Moore Solved the Pentagon’s Dilemma]]
    - [[Understanding the TTL Field][Understanding the TTL Field]]
    - [[Parsing TTL Fields with Scapy][Parsing TTL Fields with Scapy]]
  - [[Storm’s Fast-Flux and Conficker’s Domain-Flux][Storm’s Fast-Flux and Conficker’s Domain-Flux]]
    - [[Does Your DNS Know Something You Don’t?][Does Your DNS Know Something You Don’t?]]
    - [[Using Scapy to Parse DNS Traffic][Using Scapy to Parse DNS Traffic]]
    - [[Detecting Fast Flux Traffic with Scapy][Detecting Fast Flux Traffic with Scapy]]
    - [[Detecting Domain Flux Traffic with Scapy][Detecting Domain Flux Traffic with Scapy]]
  - [[Kevin Mitnick and TCP Sequence Prediction][Kevin Mitnick and TCP Sequence Prediction]]
    - [[Your Very Own TCP Sequence Prediction][Your Very Own TCP Sequence Prediction]]
    - [[Crafting a SYN Flood with Scapy][Crafting a SYN Flood with Scapy]]
    - [[Calculating TCP Sequence Numbers][Calculating TCP Sequence Numbers]]
    - [[Spoofing the TCP Connection][Spoofing the TCP Connection]]
  - [[Foiling Intrusion Detection Systems with Scapy][Foiling Intrusion Detection Systems with Scapy]]
  - [[Chapter Wrap Up][Chapter Wrap Up]]
  - [[References][References]]
- [[Chapter 5. Wireless Mayhem with Python][Chapter 5. Wireless Mayhem with Python]]
  - [[Introduction: Wireless (IN)Security and the Iceman][Introduction: Wireless (IN)Security and the Iceman]]
  - [[Setting up Your Wireless Attack Environment][Setting up Your Wireless Attack Environment]]
    - [[Testing Wireless Capture with Scapy][Testing Wireless Capture with Scapy]]
    - [[Installing Python Bluetooth Packages][Installing Python Bluetooth Packages]]
  - [[The Wall of Sheep—Passively Listening to Wireless Secrets][The Wall of Sheep—Passively Listening to Wireless Secrets]]
    - [[Using Python Regular Expressions to Sniff Credit Cards][Using Python Regular Expressions to Sniff Credit Cards]]
    - [[Sniffing Hotel Guests][Sniffing Hotel Guests]]
    - [[Building a Wireless Google Key Logger][Building a Wireless Google Key Logger]]
    - [[Sniffing FTP Credentials][Sniffing FTP Credentials]]
  - [[Where Has Your Laptop Been? Python Answers][Where Has Your Laptop Been? Python Answers]]
    - [[Listening for 802.11 Probe Requests][Listening for 802.11 Probe Requests]]
    - [[Finding Hidden Network 802.11 Beacons][Finding Hidden Network 802.11 Beacons]]
    - [[De-cloaking Hidden 802.11 Networks][De-cloaking Hidden 802.11 Networks]]
  - [[Intercepting and Spying on UAVs with Python][Intercepting and Spying on UAVs with Python]]
    - [[Intercepting the Traffic, Dissecting the Protocol][Intercepting the Traffic, Dissecting the Protocol]]
    - [[Crafting 802.11 Frames with Scapy][Crafting 802.11 Frames with Scapy]]
    - [[Finalizing the Attack, Emergency Landing The UAV][Finalizing the Attack, Emergency Landing The UAV]]
  - [[Detecting FireSheep][Detecting FireSheep]]
    - [[Understanding Wordpress Session Cookies][Understanding Wordpress Session Cookies]]
    - [[Herd the Sheep—Catching Wordpress Cookie Reuse][Herd the Sheep—Catching Wordpress Cookie Reuse]]
  - [[Stalking with Bluetooth and Python][Stalking with Bluetooth and Python]]
    - [[Intercepting Wireless Traffic to Find Bluetooth Addresses][Intercepting Wireless Traffic to Find Bluetooth Addresses]]
    - [[Scanning Bluetooth RFCOMM Channels][Scanning Bluetooth RFCOMM Channels]]
    - [[Using the Bluetooth Service Discovery Protocol][Using the Bluetooth Service Discovery Protocol]]
    - [[Taking Over a Printer with Python ObexFTP][Taking Over a Printer with Python ObexFTP]]
    - [[BlueBugging a Phone with Python][BlueBugging a Phone with Python]]
  - [[Chapter Wrap Up][Chapter Wrap Up]]
  - [[References][References]]
- [[Chapter 6. Web Recon with Python][Chapter 6. Web Recon with Python]]
  - [[Introduction: Social Engineering Today][Introduction: Social Engineering Today]]
    - [[Recon Prior to Attack][Recon Prior to Attack]]
  - [[Using the Mechanize Library to Browse the Internet][Using the Mechanize Library to Browse the Internet]]
    - [[Anonymity - Adding Proxies, User-Agents, Cookies][Anonymity - Adding Proxies, User-Agents, Cookies]]
    - [[Finalizing Our AnonBrowser into a Python Class][Finalizing Our AnonBrowser into a Python Class]]
  - [[Scraping Web Pages with AnonBrowser][Scraping Web Pages with AnonBrowser]]
    - [[Parsing HREF Links with Beautiful Soup][Parsing HREF Links with Beautiful Soup]]
    - [[Mirroring Images with Beautiful Soup][Mirroring Images with Beautiful Soup]]
  - [[Research, Investigate, Discovery][Research, Investigate, Discovery]]
    - [[Interacting with the Google API in Python][Interacting with the Google API in Python]]
    - [[Parsing Tweets with Python][Parsing Tweets with Python]]
    - [[Pulling Location Data Out of Tweets][Pulling Location Data Out of Tweets]]
    - [[Parsing Interests from Twitter Using Regular Expressions][Parsing Interests from Twitter Using Regular Expressions]]
  - [[Anonymous Email][Anonymous Email]]
  - [[Mass Social Engineering][Mass Social Engineering]]
    - [[Using Smtplib to Email Targets][Using Smtplib to Email Targets]]
    - [[Spear Phishing with Smtplib][Spear Phishing with Smtplib]]
  - [[Chapter Wrap-Up][Chapter Wrap-Up]]
  - [[References][References]]
- [[Chapter 7. Antivirus Evasion with Python][Chapter 7. Antivirus Evasion with Python]]
  - [[Introduction: Flame On!][Introduction: Flame On!]]
  - [[Evading Antivirus Programs][Evading Antivirus Programs]]
  - [[Verifying Evasion][Verifying Evasion]]
  - [[Wrap Up][Wrap Up]]
  - [[References][References]]
- [[Index][Index]]

* Trademarks
* Dedication
* Lead Author – TJ O’Connor
* Contributing Author Bio – Rob Frost
* Technical Editor Bio – Mark Baggett
* Introduction
* TODO Chapter 1. Introduction
** TODO Introduction: A Penetration Test with Python
** TODO Setting Up Your Development Environment
*** Installing Third Party Libraries
*** Interpreted Python Versus Interactive Python

** TODO The Python Language
*** Variables
*** Strings
*** Lists
*** Dictionaries
*** Networking
*** Selection
*** Exception Handling
*** Functions
*** Iteration
*** File I/O
*** Sys Module
*** OS Module

** TODO Your First Python Programs
*** Setting the Stage for Your First Python Program: The Cuckoo’s Egg
*** Your First Program, a UNIX Password Cracker
*** Setting the Stage for Your Second Program: Using Evil for Good
*** Your Second Program, a Zip-File Password Cracker

** TODO Chapter Wrap-Up
** TODO References

* TODO Chapter 2. Penetration Testing with Python
** TODO Introduction: The Morris Worm—Would it Work Today?
** TODO Building a Port Scanner
*** TCP Full Connect Scan
*** Application Banner Grabbing
*** Treading the Scan
*** Itegrating the Nmap Port Scanner

** TODO Building an SSH BotNet with Python
*** Interacting with SSH Through Pexpect
*** Brute Forcing SSH Passwords with Pxssh
*** Exploiting SSH Through Weak Private Keys
*** Constructing the SSH Botnet

** TODO Mass Compromise by Bridging FTP and Web
*** Building an Anonymous FTP Scanner with Python
*** Using Ftplib to Brute Force FTP User Credentials
*** Searching for Web Pages on the FTP Server
*** Adding a Malicious Inject to Web Pages
*** Bringing the Entire Attack Together

** TODO Conficker, Why Trying Hard is Always Good Enough
*** Attacking the Windows SMB Service with Metasploit
*** Writing Python to Interact with Metasploit
*** Remote Process Execution Brute Force
*** Putting it Back Together to Build Our Own Conficker

** TODO Writing Your Own Zero-Day Proof of Concept Code
*** Stack-Based Buffer Overflow Attacks
*** Adding the Key Elements of the Attack
*** Sending the Exploit
*** Assembling the Entire Exploit Script

** TODO Chapter Wrap Up
** TODO References

* TODO Chapter 3. Forensic Investigations with Python
** TODO Introduction: How Forensics Solved the BTK Murders
** TODO Where Have You Been?—Analysis of Wireless Access Points in the Registry
*** Using WinReg to Read the Windows Registry
*** Using Mechanize to Submit the MAC Address to Wigle
** TODO Using Python to Recover Deleted Items in the Recycle Bin
*** Using the OS Module to Find Deleted Items
*** Python to Correlate SID to User

** TODO Metadata
*** Using PyPDF to Parse PDF Metadata
*** Understanding Exif Metadata
*** Downloading Images with BeautifulSoup
*** Reading Exif Metadata from Images with the Python Imaging Library

** TODO Investigating Application Artifacts with Python
*** Understanding the Skype Sqlite3 Database
*** Using Python and Sqlite3 to Automate Skype Database Queries
*** Parsing Firefox Sqlite3 Databases with Python

** TODO Investigating iTunes Mobile Backups with Python
** TODO Chapter Wrap-Up
** TODO References

* TODO Chapter 4. Network Traffic Analysis with Python
** TODO Introduction: Operation Aurora and How the Obvious was Missed
** TODO Where is that IP Traffic Headed?—A Python Answer
*** Using PyGeoIP to Correlate IP to Physical Locations
*** Using Dpkt to Parse Packets
*** Using Python to Build a Google Map

** TODO Is Anonymous Really Anonymous? Analyzing LOIC Traffic
*** Using Dpkt to Find the LOIC Download
*** Parsing IRC Commands to the Hive
*** Identifying the DDoS Attack in Progress

** TODO How H D Moore Solved the Pentagon’s Dilemma
*** Understanding the TTL Field
*** Parsing TTL Fields with Scapy

** TODO Storm’s Fast-Flux and Conficker’s Domain-Flux
*** Does Your DNS Know Something You Don’t?
*** Using Scapy to Parse DNS Traffic
*** Detecting Fast Flux Traffic with Scapy
*** Detecting Domain Flux Traffic with Scapy

** TODO Kevin Mitnick and TCP Sequence Prediction
*** Your Very Own TCP Sequence Prediction
*** Crafting a SYN Flood with Scapy
*** Calculating TCP Sequence Numbers
*** Spoofing the TCP Connection

** TODO Foiling Intrusion Detection Systems with Scapy
** TODO Chapter Wrap Up
** TODO References

* TODO Chapter 5. Wireless Mayhem with Python
** TODO Introduction: Wireless (IN)Security and the Iceman
** TODO Setting up Your Wireless Attack Environment
*** Testing Wireless Capture with Scapy
*** Installing Python Bluetooth Packages

** TODO The Wall of Sheep—Passively Listening to Wireless Secrets
*** Using Python Regular Expressions to Sniff Credit Cards
*** Sniffing Hotel Guests
*** Building a Wireless Google Key Logger
*** Sniffing FTP Credentials

** TODO Where Has Your Laptop Been? Python Answers
*** Listening for 802.11 Probe Requests
*** Finding Hidden Network 802.11 Beacons
*** De-cloaking Hidden 802.11 Networks

** TODO Intercepting and Spying on UAVs with Python
*** Intercepting the Traffic, Dissecting the Protocol
*** Crafting 802.11 Frames with Scapy
*** Finalizing the Attack, Emergency Landing The UAV

** TODO Detecting FireSheep
*** Understanding Wordpress Session Cookies
*** Herd the Sheep—Catching Wordpress Cookie Reuse

** TODO Stalking with Bluetooth and Python
*** Intercepting Wireless Traffic to Find Bluetooth Addresses
*** Scanning Bluetooth RFCOMM Channels
*** Using the Bluetooth Service Discovery Protocol
*** Taking Over a Printer with Python ObexFTP
*** BlueBugging a Phone with Python

** TODO Chapter Wrap Up
** TODO References

* TODO Chapter 6. Web Recon with Python
** TODO Introduction: Social Engineering Today
*** Recon Prior to Attack

** TODO Using the Mechanize Library to Browse the Internet
*** Anonymity - Adding Proxies, User-Agents, Cookies
*** Finalizing Our AnonBrowser into a Python Class

** TODO Scraping Web Pages with AnonBrowser
*** Parsing HREF Links with Beautiful Soup
*** Mirroring Images with Beautiful Soup

** TODO Research, Investigate, Discovery
*** Interacting with the Google API in Python
*** Parsing Tweets with Python
*** Pulling Location Data Out of Tweets
*** Parsing Interests from Twitter Using Regular Expressions

** TODO Anonymous Email
** TODO Mass Social Engineering
*** Using Smtplib to Email Targets
*** Spear Phishing with Smtplib

** TODO Chapter Wrap-Up
** TODO References

* TODO Chapter 7. Antivirus Evasion with Python
** Introduction: Flame On!
** Evading Antivirus Programs
** Verifying Evasion
** Wrap Up
** References

* Index
